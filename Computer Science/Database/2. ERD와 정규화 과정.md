# ERD와 정규화 과정

## 목차

- [개요](#개요)
- [핵심 용어](핵심-용어)
- [ERD의 중요성](#erd의-중요성)
- [정규화 과정](#정규화-과정)
    - [데이터베이스 이상 현상](#데이터베이스-이상-현상-anomaly)
    - [정규형](#정규형)
    - [정규형 원칙](#정규형-원칙)
    - [제1정규형](#제1정규형)
    - [제2정규형](#제2정규형)
    - [제3정규형](#제3정규형)
    - [보이스코드 정규형](#보이스코드-정규형-bcnf-boyce-codd-normal-form)
    - [정규화 과정 정리](#정규화-과정-정리)
- [참고 자료](#참고-자료)

## 개요

ERD의 중요성과 ERD 정규화 과정에 대해 살펴본다.

## 핵심 용어
- `ERD`: 'Entity Relationship Diagram'의 약자로 릴레이션 간의 관계들을 정의한 것

## ERD의 중요성

- ERD는 시스템의 요구 사항을 기반으로 작성되며 작성된 ERD를 기반으로 데이터베이스를 구축한다.
- 디버깅 또는 비즈니스 프로세스 재설계가 필요한 경우 설계도 역할을 담당하기도 한다.
- 관계형 구조로 표현할 수 있는 데이터를 구성하는데 유용하지만 비정형 데이터는 충분히 표현할 수 없다.

> 비정형 데이터: 비구조화 데이터를 말하며, 미리 정의된 데이터 모델이 없거나 미리 정의된 방식으로 정리되지 않은 정보를 말한다.

## 정규화 과정

- **의미**: 릴레이션 간의 잘못된 종속 관계로 인해 데이터베이스 이상 현상이 일어나서 이를 해결하거나, 저장 공간을 효율적으로 사용하기 위해 **릴레이션을 여러 개로 분리하는 과정**

### 데이터베이스 이상 현상 (Anomaly)

- **삽입 이상(Insertion Anomaly)**: 릴레이션에 데이터를 삽입할 때 의도와는 상관없이 원하지 않은 값들도 함께 삽입되는 현상
- **삭제 이상(Deletion Anomaly)**: 릴레이션에서 한 튜플을 삭제할 때 의도와는 상관없는 값들도 함께 삭제되는 연쇄 삭제 이상이 일어나는 현상
- **갱신 이상(Update Anomaly)**: 릴레이션에서 튜플에 있는 속성값들을 갱신할 때 일부 튜플의 정보만 갱신되어 정보에 모순이 생기는 현상

### 정규형

- **의미**: 정규화된 정도를 표현하는 단위
- 특징
    - 정규형의 차수가 높아질수록 요구되는 제약조건이 많아지고 엄격해진다.
    - 기본 정규형: 제1정규형, 제2정규형, 제3정규형, 보이스/코드 정규형
    - 고급 정규형: 제4정규형, 제5정규형

### 정규형 원칙

1. 무손실 분해: 분해로 인한 정보 손실이 발생하지 않아야 하며 분해된 테이블을 조인하면 복원이 가능해야 한다.
2. 분해하면 분해할수록 데이터의 중복성을 감소시켜야 한다.
3. 분리의 원칙: 독립적인 관계는 별개의 테이블로 표현해야 한다.

### 제1정규형

- 릴레이션의 **모든 도메인이 원자 값(atomic value)**만으로 구성되어 있어야 한다.

### 제2정규형

- 릴레이션이 제1정규형이며 **부분 함수의 종속성을 제거**한 형태이다. 즉, 기본키가 아닌 모든 속성이 기본키에 대하여 **완전 함수적 종속 관계**를 만족해야 한다.
- 제2정규형에서도 **이행적 함수 종속**이 존재하여 이상 현상이 발생할 수 있다.

> **부분 함수의 종속성 제거**: 기본키가 아닌 모든 속성이 기본키에 완전 함수 종속적인 것이다. <br>
> **이행적 함수 종속(transitive FD)**: X->Y, Y->Z의 관계일 때, 논리적으로 X->Z의 관계가 성립되는데, 이때 Z가 X에 이행적으로 함수 종속되었다고 표현한다.

### 제3정규형

- 릴레이션이 제2정규형이며 기본키가 아닌 모든 속성이 **이행적 함수 종속을 만족하지 않는** 형태를 말한다.

> **결정자**: 함수 종속 관계에서 특정 종속자(dependent)를 결정짓는 요소, 'X->Y'일 때 X는 결정자, Y는 종속자이다.

### 보이스/코드 정규형 (BCNF, Boyce Codd Normal Form)

- 릴레이션이 제3정규형이며 모든 결정자가 후보키인 상태를 말한다.

- BCNF 제약 조건
    - 키가 아닌 모든 속성은 각 키에 대해 완전 종속해야 한다.
    - 키가 아닌 모든 속성은 그 자신이 부분적으로 들어가 있지 않은 모든 키에 대하여 완전 종속해야한다.
    - 어떤 속성도 키가 아닌 속성에 대해서는 완전 종속할 수 없다.

### 정규화 과정 정리

<img width="400" alt="image" src="https://github.com/k2645/basic-computer-science/assets/62226667/9bfb8c58-26e1-446b-bfc2-4aca8a6ca7e5">


## 참고 자료

- 블로그
    - [[데이터베이스] 정규화, 함수 종속 관계, 정규형](https://hongcana.tistory.com/112)
    - [[DB] 정규화(Normalization)](https://jess2.tistory.com/50)